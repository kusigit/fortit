{"version":3,"file":"fwc-data-table.js","sourceRoot":"","sources":["fwc-data-table.ts"],"names":[],"mappings":"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","sourcesContent":["import { css, LitElement } from 'lit';\nimport { property } from 'lit/decorators/property.js';\nimport { state } from 'lit/decorators/state.js';\nimport { dynMsg, formatDate } from '../base/base.js';\n\nimport '@material/mwc-icon-button';\n\nexport class DataTable extends LitElement {\n  static styles = [\n    css`\n      :host {\n        display: block;\n      }\n\n      table {\n        position: relative;\n        table-layout: fixed;\n        width: 100%;\n        border-spacing: 0px;\n        border-collapse: collapse;\n        --mdc-icon-button-size: 32px;\n      }\n\n      table th {\n        font-size: 12px;\n        font-weight: 500;\n        height: 56px;\n        line-height: 56px;\n        padding: 0 var(--padding-small) 0 var(--padding-small);\n        text-align: left;\n      }\n\n      :host-context([mode='modal']) table th,\n      :host-context([mode='modal']) table td {\n        padding: 0 var(--padding-small) 0 0;\n      }\n\n      :host-context([mode='modal']) table th:not(.wide),\n      :host-context([mode='modal']) table td:not(.wide) {\n        padding-right: 0;\n      }\n\n      table .actions {\n        position: absolute;\n        left: 0;\n        right: 0;\n        padding: 9.5px var(--padding-small);\n        margin-top: -51px;\n        opacity: 0;\n        text-align: right;\n        background: linear-gradient(\n          -90deg,\n          var(--material-color-grey-100) 230px,\n          rgba(0, 0, 0, 0.04) 230px\n        );\n      }\n\n      table .actions:hover,\n      table tr:hover + .actions {\n        opacity: 1;\n      }\n\n      table th .header {\n        display: flex;\n        align-items: center;\n        white-space: nowrap;\n      }\n\n      table th .title {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin-right: 8px;\n      }\n\n      table th mwc-icon-button {\n        height: 24px;\n        vertical-align: middle;\n        visibility: hidden;\n        transform: rotate(90deg);\n        --mdc-icon-button-size: 24px;\n      }\n\n      table th:hover mwc-icon-button {\n        color: gray;\n        display: inline-block;\n        visibility: visible;\n      }\n\n      table th mwc-icon-button.asc {\n        visibility: visible;\n        transform: rotate(90deg);\n      }\n\n      table th mwc-icon-button.desc {\n        visibility: visible;\n        transform: rotate(-90deg);\n      }\n\n      table thead .action {\n        border-bottom: 1px solid rgba(0, 0, 0, 0.12);\n      }\n\n      table.wide th:last-child {\n        padding-right: var(--padding-medium);\n      }\n\n      table.wide td:last-child {\n        padding-right: 0;\n      }\n\n      table tbody td {\n        font-size: 13px;\n        height: 51px;\n        white-space: nowrap;\n        padding: 0 var(--padding-small) 0 var(--padding-small);\n        border-top: 1px solid rgba(0, 0, 0, 0.12);\n      }\n\n      table th.right,\n      table td.right {\n        text-align: right;\n        padding-right: 16px;\n      }\n\n      table tbody td mwc-checkbox {\n        margin-left: -15px;\n      }\n\n      table thead .filter th {\n        height: 51px;\n        border-top: 1px solid rgba(0, 0, 0, 0.12);\n      }\n\n      table input[type='text'] {\n        outline: none;\n        width: 100%;\n        padding: 4px 0;\n        border-color: rgba(0, 0, 0, 0.38);\n        border-width: 0 0 1px 0;\n        background-color: transparent;\n      }\n\n      table input[type='text']:hover {\n        border-color: black;\n      }\n\n      table input[type='text']:focus {\n        border-color: var(--mdc-theme-primary);\n      }\n\n      :host-context([mode='modal']) table .filter,\n      :host-context([mode='modal']) table .wide,\n      :host-context([mode='modal']) table .actions {\n        display: none;\n      }\n\n      .ellipsis {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n\n      .action-row {\n        display: flex;\n        align-items: center;\n      }\n\n      .selection {\n        flex-grow: 1;\n        padding-left: var(--padding-medium);\n      }\n\n      table tr.remove {\n        border-bottom-color: rgba(var(--mdc-theme-secondary-rgb), 0.5);\n        background-color: rgba(var(--mdc-theme-secondary-rgb), 0.5);\n      }\n\n      table tbody td.level-1 {\n        padding-left: 40px;\n      }\n\n      table tbody td.level-2 {\n        padding-left: 64px;\n      }\n\n      table tbody td.level-3 {\n        padding-left: 88px;\n      }\n\n      table tbody td.level-4 {\n        padding-left: 112px;\n      }\n\n      @media screen {\n        table tbody tr.error {\n          background-color: var(--paper-red-50);\n        }\n      }\n    `,\n  ];\n\n  @property()\n  mode = '';\n\n  @state()\n  allDatas: any[] = [];\n\n  @state()\n  datas: any[] = [];\n\n  @state()\n  filter: { [field: string]: string } = {};\n\n  @state()\n  order: { [field: string]: string } = {\n    name: 'asc',\n  };\n\n  setData<T>(datas: T[]): void {\n    this.datas = datas;\n    this.allDatas = datas;\n  }\n\n  sort(field: string) {\n    Object.keys(this.order).forEach((f) => {\n      if (f !== field) {\n        delete this.order[f];\n      }\n    });\n\n    this.order[field] = this.order[field] === 'asc' ? 'desc' : 'asc';\n    const datas = [...this.datas];\n\n    datas.sort((a: unknown, b: unknown) => {\n      if (this.order[field] === 'asc') {\n        // @ts-ignore\n        return a[field] > b[field] ? 1 : -1;\n      }\n      // @ts-ignore\n      return a[field] < b[field] ? 1 : -1;\n    });\n\n    this.datas = datas;\n  }\n\n  setFilter(field = '', value = '') {\n    if (value === '') {\n      delete this.filter[field];\n    } else {\n      this.filter[field] = value;\n    }\n\n    this.datas = this.allDatas.filter((item: any) =>\n      Object.entries(this.filter).every(([key, search]) => {\n        let val = item[key];\n\n        switch (key) {\n          case 'state':\n            val = dynMsg(item[key]);\n            break;\n\n          case 'changed_at':\n          case 'created_at':\n          case 'date':\n          case 'last_assessment':\n            val = formatDate(item[key]);\n            break;\n\n          default:\n            break;\n        }\n\n        const regEx = new RegExp(search, 'i');\n        return regEx.test(val);\n      })\n    );\n  }\n}\n"]}